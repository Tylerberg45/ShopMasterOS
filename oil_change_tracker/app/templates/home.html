{% extends "layout.html" %}
{% block content %}
<div class="mb-4">
  <h1 class="mb-2">Oil Change Tracker</h1>
</div>

<form method="post" action="/ui/search" class="row g-3 mb-4 align-items-end">
  <div class="col-md-8">
    <label for="searchInput" class="form-label">Search by name or phone</label>
    <input id="searchInput" name="name_or_phone" class="form-control" placeholder="First Last or Phone">
  </div>
  <div class="col-md-4">
    <button type="submit" class="btn btn-primary w-100">Search</button>
  </div>
</form>

<div class="card mb-4">
  <div class="card-body">
    <h3 class="card-title">Add New Customer</h3>
    <form method="post" action="/ui/customer/new" class="row g-2 align-items-end" id="addCustomerForm">
      <div class="col-md-4">
        <input id="firstNameInput" name="first_name" class="form-control" placeholder="First name" value="{{ pre_fill.first_name if pre_fill else '' }}">
      </div>
      <div class="col-md-4">
        <input id="lastNameInput" name="last_name" class="form-control" placeholder="Last name" value="{{ pre_fill.last_name if pre_fill else '' }}">
      </div>
      <div class="col-md-4">
        <input id="phoneInput" name="phone" class="form-control" placeholder="Phone (digits only)" value="{{ pre_fill.phone if pre_fill else '' }}">
      </div>
      <div class="col-md-4 d-grid">
        <button type="submit" class="btn btn-success" id="createBtn">Create</button>
      </div>
    </form>
  </div>
</div>

<div class="card mb-4 border-warning">
  <div class="card-body">
    <h3 class="card-title text-warning">
      <i class="fas fa-users-cog"></i> Admin Tools
    </h3>
    <p class="card-text">Manage duplicate customers and system maintenance</p>
    <div class="d-grid col-md-3">
      <a href="/admin/duplicates" class="btn btn-warning">
        <i class="fas fa-search"></i> Find Duplicates
      </a>
    </div>
  </div>
</div>

{% if pre_fill %}
<script>
  // If pre_fill is present, focus the first empty field in the add form
  (function(){
    const first = document.getElementById('firstNameInput');
    const last = document.getElementById('lastNameInput');
    const phone = document.getElementById('phoneInput');
    // put cursor in the first empty field
    if (first && !first.value) { first.focus(); return; }
    if (last && !last.value) { last.focus(); return; }
    if (phone && !phone.value) { phone.focus(); return; }
    // otherwise place cursor in Create button
    document.getElementById('createBtn').focus();
  })();
</script>
{% endif %}

{% endblock %}
