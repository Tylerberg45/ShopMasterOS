
{% extends "layout.html" %}
{% block content %}
<div class="mb-4">
  <h2 class="mb-1">AI Advisor <span class="badge bg-secondary">Preview</span></h2>
  <div class="muted mb-2">This page summarizes usage and offers suggestions. Click <strong>Generate Report</strong> to save a shareable report you can send to ChatGPT for deeper analysis.</div>
</div>

<div class="card mb-4">
  <div class="card-body">
    <h4 class="card-title">Metrics (last 30 days)</h4>
    <ul class="mb-2">
      <li>Total searches: <strong>{{ metrics.search_total }}</strong> (no result: {{ metrics.search_no_result }} → {{ (metrics.search_no_result_rate*100)|round(0) }}%)</li>
      <li>Oil change deducts: <strong>{{ metrics.deducts }}</strong>, restores: <strong>{{ metrics.restores }}</strong> (restore ratio: {{ (metrics.restore_ratio*100)|round(0) }}%)</li>
      <li>Vehicles added: <strong>{{ metrics.vehicles_added }}</strong>, spec lookups: <strong>{{ metrics.spec_lookups }}</strong></li>
    </ul>
    {% if metrics.top_search_terms %}
      <h6 class="mt-3">Top search terms</h6>
      <ol class="mb-2">
        {% for term, cnt in metrics.top_search_terms %}
        <li>{{ term }} — {{ cnt }}</li>
        {% endfor %}
      </ol>
    {% endif %}
  </div>
</div>

<div class="card mb-4">
  <div class="card-body">
    <h4 class="card-title">Suggestions</h4>
    <ul>
      {% for t in tips %}
      <li>{{ t }}</li>
      {% endfor %}
    </ul>
  </div>
</div>

<form method="post" action="/advisor/run" class="mb-3">
  <button class="btn btn-primary" type="submit">Generate Report</button>
</form>
<div class="muted">Reports are saved under <code>./app/reports/</code> on the thumb drive.</div>
{% endblock %}
